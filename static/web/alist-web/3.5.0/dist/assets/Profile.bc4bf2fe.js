import{u as I,d as i,a2 as n,a as k,b4 as v,e,k as u,a1 as l,b$ as S,c0 as T,c1 as C,c2 as F,$ as a,bb as g,be as B,c3 as U,aY as d,aW as h,I as m,F as x,B as p,bc as y,c4 as A,n as P,t as R,ad as H,V as M,bt as D}from"./index.990867b1.js";import{u as L}from"./useT.e3a47100.js";import{b as V}from"./useTitle.61c80c89.js";import{O as W}from"./index.b00468c5.js";const G=r=>e(D,{get colorScheme(){return r.can?"success":"danger"},get children(){return r.children}}),z=()=>{const r=L();V("manage.sidemenu.profile");const{to:o}=I(),[s,f]=i(n().username),[c,w]=i(""),[$,b]=k(()=>v.post("/me/update",{username:s(),password:c()}));return e(M,{w:"$full",spacing:"$4",alignItems:"start",get children(){return[e(u,{get when(){return!l.is_guest(n())},get fallback(){return[e(S,{status:"warning",flexDirection:{"@initial":"column","@lg":"row"},get children(){return[e(T,{mr:"$2_5"}),e(C,{mr:"$2_5",get children(){return r("users.guest-tips")}}),e(F,{get children(){return r("users.modify_nothing")}})]}}),e(a,{spacing:"$2",get children(){return[e(g,{get children(){return r("global.have_account")}}),e(g,{color:"$info9",as:W,get href(){return`/@login?redirect=${encodeURIComponent(location.pathname)}`},get children(){return r("global.go_login")}})]}})]},get children(){return[e(B,{get children(){return r("users.update_profile")}}),e(U,{gap:"$2",columns:{"@initial":1,"@md":2},get children(){return[e(d,{get children(){return[e(h,{for:"username",get children(){return r("users.change_username")}}),e(m,{id:"username",get value(){return s()},onInput:t=>{f(t.currentTarget.value)}})]}}),e(d,{get children(){return[e(h,{for:"password",get children(){return r("users.change_password")}}),e(m,{id:"password",type:"password",placeholder:"********",get value(){return c()},onInput:t=>{w(t.currentTarget.value)}}),e(x,{get children(){return r("users.change_password-tips")}})]}})]}}),e(a,{spacing:"$2",get children(){return[e(p,{get loading(){return $()},onClick:async()=>{const t=await b();y(t,()=>{A({...n(),username:s()}),P.success(r("users.update_profile_success")),o(`/@login?redirect=${encodeURIComponent(location.pathname)}`)})},get children(){return r("global.save")}}),e(u,{get when(){return!n().otp},get children(){return e(p,{colorScheme:"accent",onClick:()=>{o("/@manage/2fa")},get children(){return r("users.enable_2fa")}})}})]}})]}}),e(a,{wrap:"wrap",gap:"$2",mt:"$2",get children(){return e(R,{each:H,children:(t,_)=>e(G,{get can(){return l.can(n(),_())},get children(){return r(`users.permissions.${t}`)}})})}})]}})};export{z as default};
