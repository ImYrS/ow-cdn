import{bE as b,a3 as x,d as P,a as o,b6 as u,aq as j,e as t,bf as g,k as h,$ as f,H,ag as V,V as k,bc as m,aA as l,bv as p,bI as D,B as i,T as E,bd as G,aM as c}from"./index.56603356.js";import{m as Z,u as A}from"./api.60f8b30e.js";import{u as F}from"./useT.303c7e81.js";import{G as W}from"./index.a56841cc.js";import X from"./Common.4f45aa82.js";import"./useTitle.f1b35a2e.js";import"./index.f1ab4103.js";import"./SettingItem.6ff59837.js";import"./item_type.be442da4.js";import"./ResponsiveGrid.7fddc5ff.js";const J=x('<svg width="1em" height="1em" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"></animate></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"></animate><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"></animateTransform></path></g></svg>'),K=x('<svg width="1em" height="1em" viewBox="0 0 24 24"><g stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path fill="currentColor" fill-opacity="0" stroke-dasharray="60" stroke-dashoffset="60" d="M3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"></animate><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.15s" values="0;0.3"></animate></path><path fill="none" stroke-dasharray="14" stroke-dashoffset="14" d="M8 12L11 15L16 10"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="14;0"></animate></path></g></svg>');function O(r){return(()=>{const n=J.cloneNode(!0);return b(n,r,!0,!0),n})()}function Q(r){return(()=>{const n=K.cloneNode(!0);return b(n,r,!0,!0),n})()}const le=()=>{const r=F(),[n,C]=P(),[w,$]=o(()=>u.get("/admin/index/progress")),a=async()=>{const e=await $();G(e,s=>{C(s)})},v=setInterval(a,5e3);j(()=>clearInterval(v)),a();const[_,y]=o(Z),I=async()=>{const e=await y();c(e),a()},[S,L]=o(()=>u.post("/admin/index/clear")),N=async()=>{const e=await L();c(e),a()},[B,M]=o(()=>u.post("/admin/index/stop")),R=async()=>{const e=await M();c(e),a()};let d;const[T,q]=o(A),z=async()=>{let e=[];d.value&&(e=d.value.split(`
`));const s=await q(e);c(s),a()};return t(k,{spacing:"$2",w:"$full",alignItems:"start",get children(){return[t(g,{get children(){return r("manage.sidemenu.settings")}}),t(X,{get group(){return W.INDEX}}),t(g,{get children(){return r("indexes.current")}}),t(h,{get when(){return n()},get children(){return t(f,{spacing:"$2",w:"fit-content",shadow:"$md",rounded:"$lg",get bg(){return H("","$neutral3")()},get children(){return[t(V,{boxSize:"$28",color:"$accent9",p:"$2",get as(){var e;return(e=n())!=null&&e.is_done?Q:O}}),t(k,{spacing:"$2",flex:"1",alignItems:"start",mr:"$2",get children(){return[t(m,{get children(){return[l(()=>r("indexes.obj_count")),":",t(p,{colorScheme:"info",ml:"$2",get children(){var e;return(e=n())==null?void 0:e.obj_count}})]}}),t(m,{get children(){return[l(()=>r("indexes.last_done_time")),":",t(p,{colorScheme:"accent",ml:"$2",get children(){return l(()=>!!n().last_done_time,!0)()?D(n().last_done_time):r("indexes.unknown")}})]}}),t(h,{get when(){var e;return(e=n())==null?void 0:e.error},get children(){return t(m,{css:{wordBreak:"break-all"},get children(){return[l(()=>r("indexes.error")),":",t(p,{colorScheme:"danger",ml:"$2",get children(){return n().error}})]}})}})]}})]}})}}),t(f,{spacing:"$2",get children(){return[t(i,{colorScheme:"accent",onClick:[a,void 0],get loading(){return w()},get children(){return r("global.refresh")}}),t(i,{colorScheme:"danger",onClick:[N,void 0],get loading(){return S()},get children(){return r("indexes.clear")}}),t(i,{colorScheme:"warning",onClick:[R,void 0],get loading(){return B()},get children(){return r("indexes.stop")}}),t(i,{onClick:[I,void 0],get loading(){return _()},get children(){var e;return r(`indexes.${(e=n())!=null&&e.is_done?"rebuild":"build"}`)}})]}}),t(g,{get children(){return r("indexes.paths_to_update")}}),t(E,{ref(e){const s=d;typeof s=="function"?s(e):d=e}}),t(i,{onClick:[z,void 0],get loading(){return T()},get children(){return r("indexes.update")}})]}})};export{le as default};
